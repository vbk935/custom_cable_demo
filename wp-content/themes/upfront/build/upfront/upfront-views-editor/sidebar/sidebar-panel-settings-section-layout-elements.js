!function(e){Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views;upfrontrjs.define(["scripts/upfront/upfront-views-editor/sidebar/sidebar-panel-settings-section"],function(t){return t.extend({initialize:function(){this.settings=_([]),this.elements=_([])},get_name:function(){return"layout"},get_title:function(){return"Layout"},on_render:function(){this.elements.each(this.render_element,this)},render_element:function(t){if(t.draggable){e(Upfront.Settings.LayoutEditor.Selectors.main);t.remove(),t.render(),this.$el.find(".panel-section-content").append(t.el),t.$el.on("mousedown",function(n){var o=e(Upfront.Settings.LayoutEditor.Selectors.main),i=e("[data-shadow="+t.shadow_id+"]"),r=o.offset(),s=i.position(),a=i.offset(),l=(t.$el.offset(),i.outerHeight()),d=i.outerWidth(),f=t.$el.clone(),g=t.$el.outerHeight(),p=t.$el.outerWidth(),u=e('<div id="element-drag-wrapper" class="upfront-ui" />'),c=e(".upfront-grid-layout-gutter-left:first, .upfront-grid-layout-gutter-right:first");i.css({position:"absolute",top:n.pageY-(a.top-s.top)-l/2,left:n.pageX-(a.left-s.left)-d/2,visibility:"hidden",zIndex:-1}).one("mousedown",function(e){}).trigger(n).one("dragstart",function(n,o){t.$el.addClass("element-drag-active"),e("body").append(u),f.appendTo(u),f.addClass("element-dragging"),f.css({position:"absolute",top:n.pageY-g/2,left:n.pageX-p/2,zIndex:999})}).on("drag",function(t,n){var o=!1;c.each(function(){if(!o){var n=e(this).offset(),i=e(this).width();t.pageX>=r.left&&t.pageX>=n.left+10&&t.pageX<=n.left+i-10&&(o=!0)}}),o?f.addClass("element-dragging-no-drop"):f.removeClass("element-dragging-no-drop"),f.css({top:t.pageY-g/2,left:t.pageX-p/2})}).one("dragstop",function(e,n){t.$el.removeClass("element-drag-active"),f.remove(),u.remove()})})}}})})}(jQuery);