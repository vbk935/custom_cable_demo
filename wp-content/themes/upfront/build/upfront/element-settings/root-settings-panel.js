!function(e){upfrontrjs.define(["scripts/upfront/element-settings/settings-container","scripts/upfront/element-settings/root-panel-mixin","scripts/upfront/settings/field-factory","scripts/upfront/settings/module-factory"],function(t,n,i,s){var r=(Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views,t.extend(_.extend({},n,{initialize:function(e){var t=this,n=[];this.options=e,this.settings=_(this.settings),this.settings.each(function(e){var r;r="SettingsItem"===e.type?new Upfront.Views.Editor.Settings.Item({title:e.title,model:t.model,className:e.className,fields:[]}):s.createModule(e.type,e||{},t.model),e.identifier&&(r.identifier=e.identifier),_.each(e.fields,function(n){var s;"change"in n&&(n.preservedChangeCallback||(n.preservedChangeCallback=n.change),n.change=function(e){n.preservedChangeCallback(e,t)},Upfront.Events.once("entity:settings:deactivate",function(){n.change=n.preservedChangeCallback})),"show"in n&&(n.preservedShowCallback||(n.preservedShowCallback=n.show),n.show=function(e){n.preservedShowCallback(e,t)},Upfront.Events.once("entity:settings:deactivate",function(){n.show=n.preservedShowCallback})),s=i.createField(n.type,_.extend({model:t.model},_.omit(n,["type"]))),e.triggerChange&&t.listenTo(s,"change changed",function(){t.save_settings(),t.model.trigger("change",t.model)}),n.identifier&&(s.identifier=n.identifier),r.fields.push(s)}),r.panel=t,r.trigger("panel:set"),n.push(r)}),this.settings=_(n)},getBody:function(){var t=e("<div />"),n=this;return this.settings.each(function(e){e.panel||(e.panel=n),e.render(),t.append(e.el)}),t}})));return r})}(jQuery);