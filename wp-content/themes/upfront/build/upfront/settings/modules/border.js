upfrontrjs.define(["scripts/upfront/settings/modules/base-module"],function(e){var t=Upfront.Settings.l10n.preset_manager,o=e.extend({className:"settings_module border_settings_item clearfix",group:!1,initialize:function(e){this.options=e||{},this.fieldCounter=0,this.currentElement="","undefined"==typeof this.options.showLabel&&(this.options.showLabel=!0);var o=this,s=this.options.state,i="";this.options.toggle=!0,"undefined"!=typeof this.options.elements&&this.fieldCounter++,"undefined"!=typeof this.options.default_element&&(this.currentElement=this.options.default_element+"-",i="border-with-fields"),this.fields=_([new Upfront.Views.Editor.Field.Toggle({model:this.model,className:"useBorder checkbox-title upfront-toggle-field",name:o.options.fields.use,label:"",default_value:1,multiple:!1,values:[{label:o.options.label||t.border,value:"yes"}],change:function(e){o.model.set(o.options.fields.use,e),o.reset_fields(e)},show:function(e,t){var o=t.closest(".upfront-settings-item-content");"yes"==e?(o.find("."+s+"-toggle-wrapper").show(),o.find("."+s+"-border-select-element").css("opacity","1")):(o.find("."+s+"-toggle-wrapper").hide(),o.find("."+s+"-border-select-element").css("opacity","0.5"))}}),new Upfront.Views.Editor.Field.Number_Unit({model:this.model,className:s+"-border-width borderWidth "+i,name:this.currentElement+o.options.fields.width,default_value:1,values:[{label:"",value:"1"}],change:function(e){o.model.set(o.currentElement+o.options.fields.width,e),"undefined"!=typeof o.options.elements&&_.each(o.options.elements,function(t){o.model.set(t.value+"-"+o.options.fields.width,e)}),this.trigger("change")}}),new Upfront.Views.Editor.Field.Select({model:this.model,className:s+"-border-type borderType "+i,name:this.currentElement+o.options.fields.type,default_value:"solid",values:[{label:"―",value:"solid"},{label:"┅",value:"dashed"},{label:"⋯",value:"dotted"}],change:function(e){o.model.set(o.currentElement+o.options.fields.type,e),"undefined"!=typeof o.options.elements&&_.each(o.options.elements,function(t){o.model.set(t.value+"-"+o.options.fields.type,e)})}}),new Upfront.Views.Editor.Field.Color({model:this.model,className:s+"-border-color upfront-field-wrap upfront-field-wrap-color sp-cf borderColor "+i+" color-label-"+this.options.showLabel,name:this.currentElement+o.options.fields.color,blank_alpha:0,label:"",default_value:"#000",spectrum:{preferredFormat:"rgb",change:function(e){if(!e)return!1;var t=e.get_is_theme_color()!==!1?e.theme_color:e.toRgbString();o.model.set(o.currentElement+o.options.fields.color,t),"undefined"!=typeof o.options.elements&&_.each(o.options.elements,function(e){o.model.set(e.value+"-"+o.options.fields.color,t)})},move:function(e){if(!e)return!1;var t=e.get_is_theme_color()!==!1?e.theme_color:e.toRgbString();o.model.set(o.currentElement+o.options.fields.color,t),"undefined"!=typeof o.options.elements&&_.each(o.options.elements,function(e){o.model.set(e.value+"-"+o.options.fields.color,t)})}}})]),"undefined"!=typeof o.options.elements&&this.fields.unshift(new Upfront.Views.Editor.Field.Select({className:s+"-border-select-element border_selectElement",name:"tagsToApply",default_value:o.model.get("tagsToApply")||"field-button",values:o.options.elements,change:function(){var e=this.get_value();o.model.set({tagsToApply:e}),o.currentElement=e+"-"}}))},reset_fields:function(e){var t,o=this;"undefined"!=typeof e&&"yes"===e&&("undefined"!=typeof this.options.elements?_.each(this.options.elements,function(e){var s=e.value+"-";t=o.get_static_field_values(o.options.prepend,s),o.update_fields(t),o.save_static_values(t,s)}):(t=this.get_static_field_values(this.options.prepend,""),this.update_fields(t),this.save_static_values(t,"")),this.$el.empty(),this.render())},save_static_values:function(e,t){this.model.set(t+this.options.fields.width,e.width),this.model.set(t+this.options.fields.type,e.type),this.model.set(t+this.options.fields.color,e.color)},get_static_field_values:function(e,t){var o={},s="";return"undefined"!=typeof this.options.prefix&&(s=this.options.prefix+"-"),o.width=this.model.get(this.clear_prepend(t+s+this.options.fields.width,e))||"",o.type=this.model.get(this.clear_prepend(t+s+this.options.fields.type,e))||"",o.color=this.model.get(this.clear_prepend(t+s+this.options.fields.color,e))||"",o},clear_prepend:function(e,t){return e.replace(t,"")},update_fields:function(e){this.fields._wrapped[this.fieldCounter+1].set_value(e.width),this.fields._wrapped[this.fieldCounter+2].set_value(e.type),this.fields._wrapped[this.fieldCounter+3].set_value(e.color),this.fields._wrapped[this.fieldCounter+3].update_input_border_color(e.color)}});return o});