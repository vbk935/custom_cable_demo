/*! asset-queue-manager 2016-03-06 */
var aqmPanel;jQuery(document).ready(function(a){"undefined"!=typeof aqm&&"undefined"!=typeof aqmData&&(aqmPanel={el:a("#aqm-panel"),menu_el:a("#wp-admin-bar-asset-queue-manager"),init:function(){this.el.html('<div class="section head scripts"><h3><div class="dashicons dashicons-admin-tools"></div>'+aqm.strings.head_scripts+'</h3></div><div class="section head styles"><h3><div class="dashicons dashicons-admin-appearance"></div>'+aqm.strings.head_styles+'</h3></div><div class="section footer scripts"><h3><div class="dashicons dashicons-admin-tools"></div>'+aqm.strings.footer_scripts+'</h3></div><div class="section footer styles"><h3><div class="dashicons dashicons-admin-appearance"></div>'+aqm.strings.footer_styles+'</h3></div><div class="section dequeued scripts"><h3><div class="dashicons dashicons-admin-tools"></div>'+aqm.strings.dequeued_scripts+'</h3></div><div class="section dequeued styles"><h3><div class="dashicons dashicons-admin-appearance"></div>'+aqm.strings.dequeued_styles+"</h3></div>");var b=this;a.each(aqmData.assets,function(c,d){("array"==a.type(d)||"object"==a.type(d))&&a.each(d,function(d,e){a.each(e,function(a,e){b.appendAsset(e,c,d)})})}),this.menu_el.click(function(){aqmPanel.toggle()}),this.menu_el.find(".inactive").remove()},appendAsset:function(b,c,d){var e='<div class="asset handle-'+b.handle+" "+d+'" data-type="'+d+'" data-handle="'+b.handle+'" data-location="'+c+'"><div class="header"><div class="handle">'+b.handle+'</div><div class="src">'+b.src+'</div><div class="dashicons dashicons-arrow-down"></div></div><div class="body">';"undefined"!=typeof b.src&&b.src.length&&(e+='<div class="src_input"><input type="text" value="'+b.src+'" readonly="readonly"></div>'),e+=this.getAssetNotices(b),"undefined"!=typeof b.deps&&b.deps.length&&(e+='<p class="deps"><strong>'+aqm.strings.deps+"</strong> "+b.deps.join(", ")+"</p>"),e+='<div class="links">',e+="dequeued"===c?'<a href="#" class="enqueue">'+aqm.strings.enqueue+"</a>":'<a href="#" class="dequeue">'+aqm.strings.dequeue+"</a>";var f=this.getAssetURL(b);f!==!1&&(e+='<a href="'+f+'" target="_blank" class="view">'+aqm.strings.view+"</a>"),e+="</div>",e+="</div>",e+="</div>",this.el.find(".section."+c+"."+d).append(e);var g=this.el.find(".asset.handle-"+b.handle.replace(/\./g,"\\.")+"."+d);g.click(function(){aqmPanel.toggleAsset(a(this))}),this.enableSrcSelect(g.find(".src_input input")),g.find(".links .dequeue, .links .enqueue").click(function(b){if(b.stopPropagation(),b.preventDefault(),!a(this).hasClass("sending")){a(this).addClass("sending");var c=a(this).parents(".asset");aqmPanel.toggleQueueState(c.data("handle"),c.data("location"),c.data("type"),a(this).hasClass("dequeue"))}})},getAssetNotices:function(a){var b="";for(var c in aqmData.notices)for(var d in aqmData.notices[c].handles)aqmData.notices[c].handles[d]===a.handle&&(b+='<p class="notice '+c+'">'+aqmData.notices[c].msg+"</p>");return a.src===!1&&(b+='<p class="notice no-src">'+aqm.strings.no_src+"</p>"),b},getAssetURL:function(a){if(!a||!a.src)return!1;var b=a.src.toString();return"//"===b.substring(0,2)?link="http:"+a.src:"/"===b.substring(0,1)?b=aqm.siteurl+a.src:"http"===b.substring(0,4)&&(b=a.src),b},toggle:function(){this.menu_el.hasClass("open")?(this.el.slideUp(),this.el.removeClass("open"),this.menu_el.removeClass("open")):(this.el.addClass("open"),this.menu_el.addClass("open"),this.el.slideDown())},toggleAsset:function(a){a.hasClass("open")?a.removeClass("open"):a.addClass("open")},enableSrcSelect:function(a){a.click(function(a){a.stopPropagation()}),a.click(function(){this.select()})},toggleQueueState:function(b,c,d,e){var f=this.el.find(".asset.handle-"+b.replace(/\./g,"\\.")+"."+d);f.find(".body .notice.request").remove(),f.find(".body").append('<p class="notice request"><span class="spinner"></span>'+aqm.strings.sending+"</p>");var g=a.param({action:"aqm-modify-asset",nonce:aqm.nonce,handle:b,type:d,dequeue:e,asset_data:aqmData.assets[c][d][b]});a.post(aqm.ajaxurl,g,function(e){var g=f.find(".notice.request");if(e.success){if("undefined"==typeof e.data)return g.addClass("error").text(aqm.strings.unknown_error),void console.log(e);g.slideUp(null,function(){a(this).remove()}),e.data.dequeue?(f.fadeOut(null,function(){a(this).remove()}),aqmPanel.appendAsset(e.data.option[e.data.type][e.data.handle],"dequeued",e.data.type),aqmData.assets.dequeued===!1&&(aqmData.assets.dequeued=[]),"undefined"==typeof aqmData.assets.dequeued[d]&&(aqmData.assets.dequeued[d]=[]),aqmData.assets.dequeued[d][e.data.handle]=aqmData.assets[c][d][b]):f.addClass("requeued").find(".body").empty().append('<p class="notice requeued">'+aqm.strings.requeued+"</p>")}else"undefined"==typeof e.data||"undefined"==typeof e.data.msg?g.addClass("error").text(aqm.strings.unknown_error):g.addClass("error").text(e.data.msg);f.find(".links .sending").removeClass("sending")})}},aqmPanel.init())});